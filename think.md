# ç”¨Foliouå¼€å‘ç»„ä»¶

## ç”¨Foliouå¼€å‘ç»„ä»¶çš„ä¼˜åŠ¿

* æ”¯æŒåœ¨jsä¸­require css/scss/lessæ–‡ä»¶
* æ”¯æŒjsä¸­ require htmlæ–‡ä»¶
* æ”¯æŒåœ¨ html ä»¥ç›¸å¯¹è·¯å¾„å¼•å…¥å›¾ç‰‡
* æ”¯æŒåœ¨css ä¸­ä»¥ç›¸å¯¹è·¯å¾„å¼•å…¥å›¾ç‰‡
* å¿«é€Ÿå¼€å‘æ¼”ç¤ºç¤ºä¾‹
* ä¸€é”®æ‰“åŒ…
* ä¸€é”®å‘å¸ƒ
* æ”¯æŒå¯¼å‡ºrequirejsç»„ä»¶

## éœ€æ±‚æ˜¯ä»€ä¹ˆ

æˆ‘ä»¬å·¥ä½œçš„å†…å®¹å¤§éƒ¨åˆ†æ˜¯æ¸¸æˆç›¸å…³çš„æ´»åŠ¨ä¸“é¢˜æˆ–è€…æ¸¸æˆçš„å®˜ç½‘ä¾‹å¦‚

[http://zt2m.ztgame.com/](http://zt2m.ztgame.com/)  
[http://jl2.ztgame.com/](http://jl2.ztgame.com/)

æœ‰å¾ˆå¤šç±»ä¼¼çš„åŠŸèƒ½å¯ä»¥å¼€å‘æˆç»„ä»¶çš„å½¢å¼æ¯”å¦‚è¯´ è½®æ’­å›¾ï¼Œè§†é¢‘æ’­æ”¾å™¨ç­‰ç­‰ï¼Œæˆ‘æƒ³è¦æŠŠè¿™äº›åŠŸèƒ½å¼€å‘å®Œæˆåå‘å¸ƒåˆ°npmä¸Šï¼Œè¿™æ ·ä»¥åä½¿ç”¨çš„è¿‡ç¨‹ä¸­å°±å¯ä»¥è¿™æ ·å†™äº†ã€‚

```javascript
//foliou æ˜¯æˆ‘çš„ç»„ä»¶é›†çš„åç§°ï¼Œå·²ç»å‘å¸ƒåˆ°äº† npm
var player = require("foliou/player");
new player("video_wrap",{
    file:'......'
});
```

æ‹¿è§†é¢‘æ’­æ”¾å™¨ç»„ä»¶æ¥è¯´ï¼Œç»„ä»¶çš„é€»è¾‘æ— éå°±æ˜¯åœ¨é¡µé¢ä¸­æ’å…¥ä¸€äº›htmlï¼Œè¿™äº›htmlå…·æœ‰æœ‰é»˜è®¤çš„æ ·å¼ï¼Œè€Œä¸”è¿˜æœ‰ä¸€äº›æŒ‰é’®å›¾ç‰‡ã€‚

ä½†æ˜¯åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­æˆ‘é‡åˆ°äº†ä¸€äº›å›°æƒ‘ã€‚

### 1.ç”¨jsæ’å…¥HTML

æœ€å¼€å§‹æˆ‘æ˜¯è¿™æ ·åšçš„ï¼Œç›´æ¥åœ¨jsä¸­å†™htmlçš„å­—ç¬¦ä¸²ï¼Œç„¶åæŠŠå®ƒæ’å…¥åˆ°å¯¹åº”çš„å®¹å™¨ä¸­

![&#x63D2;&#x5165;html&#x7ED3;&#x6784;&#x7684;&#x5B9E;&#x4F8B;](.gitbook/assets/code.png)

åœ¨HTMLä»£ç é‡å¾ˆå°‘çš„æ—¶å€™è¿™æ ·åšè²Œä¼¼æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå°±æ˜¯ä¸‘äº†ç‚¹ï¼Œæˆ‘ç›¸ä¿¡æœ‰äº›å¯¹ä»£ç è¦æ±‚å¹²å‡€çš„äººï¼Œå·²ç»å¿ä¸ä¸‹å»äº†ï¼Œ

é‚£æœ‰æ²¡æœ‰æ›´å¥½çš„åŠæ³•å‘¢ï¼Œæ˜¯å¦èƒ½HTMLå†™åœ¨.htmlä¸­ï¼Œåœ¨jsä¸­ç›´æ¥å¼•å…¥å‘¢ï¼Œå¦‚ä¸‹ï¼š

{% tabs %}
{% tab title="tpl.html" %}
```markup
<div class="POPUP-Player">
    ......
</div>
```
{% endtab %}
{% endtabs %}

{% code title="main.js" %}
```javascript
var html = require("./tpl.html");
```
{% endcode %}

### è§£å†³æ–¹æ¡ˆâ€”â€”Rollup

æˆ‘ç›¸ä¿¡å¾ˆå¤šäººçŸ¥é“è¿™å·¥å…·ï¼Œå¦‚æœä¸çŸ¥é“ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ª æ‰“åŒ…jsçš„å·¥å…·ï¼Œå°±åƒwebpackï¼ŒBrowserifyï¼Œå½“ç„¶ä»–ä»¬æœ‰æ‰€ä¸åŒã€‚

æˆ‘é€‰æ‹©Rollup çš„åŸå› ï¼š

1. å…¼å®¹æ€§
2. è½»é‡ä½†åŠŸèƒ½å¤Ÿç”¨
3. å£ç¢‘è¿˜ä¸é”™

Rollupçš„ä½¿ç”¨æ–¹æ³•æœ‰ä¸¤ç§

```text
ä½¿ç”¨ä¹‹å‰éœ€è¦å®‰è£…rollup
```

```bash
npm install rollup -g
```

1. å‘½ä»¤è¡Œ

```bash
rollup main.js --file bundle.js --format cjs
```

1. Javascript Api

{% code title="build.js" %}
```javascript
const rollup = require('rollup');
const posthtml = require("rollup-plugin-posthtml-template");
// å¯¼å…¥å¯¼å‡ºçš„å‚æ•°
const inputOptions = {
  input:"main.js",
  plugins: [
    posthtml({
      include: "./*.html"
    })
  ]
};
const outputOptions = {
  file:"bundle.js",
  format: "cjs"
};

async function build() {
  // create a bundle
  const bundle = await rollup.rollup(inputOptions);
  await bundle.write(outputOptions);
}

build();
```
{% endcode %}

```bash
node ./build.js
```

æœ‰äº†ä¸Šé¢è¿™éƒ¨åˆ†ä»£ç æˆ‘ä»¬å·²ç»å¯ä»¥åœ¨ main.jsä¸­ ç›´æ¥require htmlæ–‡ä»¶äº†ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥æŠŠæ‰“åŒ…åçš„js å‘å¸ƒåˆ°npm

css å’Œ å›¾ç‰‡æ‰“åŒ…æˆjsï¼Œæ— éå°±æ˜¯å¢åŠ ä¸¤ä¸ªæ’ä»¶ï¼Œè¿™æ ·ä»¥ååœ¨å¼€å‘ç»„ä»¶çš„æ—¶å€™ç›´æ¥åœ¨jsä¸­require ä¸€åˆ‡ï¼Œå¼€å‘ä½“éªŒæœ‰å¾ˆå¤§çš„æå‡äº†ã€‚

### è‡ªåŠ¨åŒ–

Rollupæä¾›äº†watchæ–¹æ³•æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨build.jsä¸­åŠ å…¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦æ”¹å˜ï¼Œç„¶åè‡ªåŠ¨æ‰“åŒ…çš„é€»è¾‘ï¼Œè¿™æ ·å°±ä¸ç”¨æ¯ä¸€æ¬¡ä¿®æ”¹å®Œä»£ç è¿è¡Œæ‰“åŒ…å‘½ä»¤äº†ã€‚

å¤§åŠŸå‘Šæˆ ğŸ»

### è¿›ä¸€æ­¥ä¼˜åŒ–

äº‹å®ä¸Šåœ¨å®é™…å¼€å‘ä¸­å¾ˆå¤šç»„ä»¶æ˜¯ç›¸äº’ä¾èµ–çš„æ¯”å¦‚æ‰€ "è®¾å¤‡åˆ¤æ–­"\(device\)ï¼Œåœ¨â€œè§†é¢‘æ’­æ”¾â€\(player\) å’Œ â€œè½®æ’­å›¾â€\(swiper\)ä¸­éƒ½æœ‰ä½¿ç”¨ï¼Œå¦‚æœæŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•æ‰“åŒ…çš„è¯ï¼Œdeviceçš„ä»£ç åŒæ—¶åœ¨playerå’Œswiperä¸­å­˜åœ¨ï¼›

ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æœ€åˆçš„ç›®çš„ä»…ä»…æ˜¯ä¸ºäº†æŠŠèµ„æºæ–‡ä»¶æ‰“åŒ…æˆjsæ–‡ä»¶ï¼Œå¹¶ä¸æ˜¯æƒ³è¦æŠŠç»„ä»¶å…¨éƒ¨æ‰“åŒ…æˆä¸€ä¸ªåŒ…ã€‚

å¯ä»¥è®©ç»„ä»¶åŒ…å«ä¸¤ä¸ªjsæ–‡ä»¶ä¸€ä¸ªæ˜¯å…¥å£æ–‡ä»¶ï¼Œè€Œå¦å¤–ä¸€ä¸ªæ˜¯èµ„æºæ–‡ä»¶asset.js

å…·ä½“çš„å®ç°æ–¹æ¡ˆå¦‚ä¸‹ï¼š  
1. æŠŠæ‰€æœ‰çš„èµ„æºæ–‡ä»¶å¼•å…¥åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­

{% code title="tmp.js" %}
```javascript
var assets = {};
import html from "./tpl.html";
assets["html "]=html;
import css from "./style.css";
assets["css"]=css;
export default assets;
```
{% endcode %}

1. ç„¶åç”¨rullup æ‰“åŒ…è¿™ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå¯¼å‡ºä¸º asset.jsï¼›
2. åœ¨ç»„ä»¶çš„ä¸»è¦é€»è¾‘ä¸­ä½¿ç”¨asset.js

```javascript
var Assets = require("./assets.js");
contain.append(Assets.html);
```

æœ€åå†æŠŠè¿™ä¸ªè¿‡ç¨‹ä¸­ä» ä¸´æ—¶æ–‡ä»¶çš„ç”Ÿæˆåˆ°rollupçš„æ‰“åŒ…ç”¨nodejs å…¨éƒ¨è‡ªåŠ¨åŒ–ï¼Œå…·ä½“å®ç°å°±ä¸èµ˜è¿°äº†ï¼Œè¿™ä¸ªé¡¹ç›®ä¸­å…·ä½“çš„å®ç°é€»è¾‘åœ¨ build/main.jsä¸‹

